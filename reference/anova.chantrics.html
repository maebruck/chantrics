<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ANOVA tables: compare nested models — anova.chantrics • chantrics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="ANOVA tables: compare nested models — anova.chantrics" />
<meta property="og:description" content="anova method for chantrics objects" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-45196954-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-45196954-5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chantrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/chantrics-vignette.html">An introduction to chantrics</a>
    </li>
    <li>
      <a href="../articles/clustering-vignette.html">An introduction to clustering with chantrics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tbruckbauer/chantrics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ANOVA tables: compare nested models</h1>
    <small class="dont-index">Source: <a href='https://github.com/tbruckbauer/chantrics/blob/master/R/adj_loglik_methods.R'><code>R/adj_loglik_methods.R</code></a></small>
    <div class="hidden name"><code>anova.chantrics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>anova</code> method for <code>chantrics</code> objects</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for chantrics</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>chantrics</code>, as returned by
<code><a href='adj_loglik.html'>adj_loglik()</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further objects of class <code>chantrics</code>, as returned by
<code><a href='adj_loglik.html'>adj_loglik()</a></code>, and/or parameters that will be passed to
<code><a href='https://rdrr.io/pkg/chandwich/man/compare_models.html'>chandwich::compare_models()</a></code>. The type of adjustment, out of
<code>"vertical"</code>, <code>"cholesky"</code>, <code>"spectral"</code>, <code>"none"</code>, as
specified in the parameter <code>type</code>, can also be specified here.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code>.
The columns are as follows:</p>
<dt>Resid.df</dt><dd><p>The residual number of degrees
of freedom in the model.</p></dd> <dt>df</dt><dd><p>The increase in residual degrees of
freedom with respect to the model in the row above.</p></dd> <dt>ALRTS</dt><dd><p>The
adjusted likelihood ratio statistic.</p></dd> <dt>Pr(&gt;ALRTS)</dt><dd><p>The p-value of the
test that the model above is a "significantly better" model as the one in
the current row.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Create an analysis of adjusted deviance table for one object (sequential), or
two or more nested models that have been adjusted using the
<code><a href='adj_loglik.html'>adj_loglik()</a></code> method. It uses the adjusted likelihood ratio test
statistic (ALRTS), as described in Section 3.5 of
<a href='http://doi.org/10.1093/biomet/asm015'>Chandler and Bate (2007)</a>.</p>
<p>Each line represents the model as given above the table, with each
line (except for the first line) showing the residual degrees of freedom of
that model, and the change in degrees of freedom, the ALRTS and the
associated p-value in comparison to the model in the line above.</p>
<p>When a single model is specified, the function returns a sequential
analysis of deviance table, where, iteratively, one term is being removed
from the right of the full formula. This process is continued until the
"intercept only" model is left. The row names are the names of the dropped
term in comparison to the model in the line above.</p>
<p>If more than one model is specified, the function sorts the models by their
number of variables as returned by <code><a href='adj_loglik.html'>adj_loglik()</a></code> in
<code><a href='https://rdrr.io/r/base/attr.html'>attr(x, "p_current")</a></code>.</p>
<p>Details of the ALRT can be found in <code><a href='https://rdrr.io/pkg/chandwich/man/compare_models.html'>chandwich::compare_models()</a></code> and in
<a href='http://doi.org/10.1093/biomet/asm015'>Chandler and Bate (2007)</a>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>R. Chandler and S. Bate, Inference for clustered data using the
independence loglikelihood, Biometrika, 94 (2007), pp.
167–183. <a href='http://doi.org/10.1093/biomet/asm015'>http://doi.org/10.1093/biomet/asm015</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/pkg/chandwich/man/compare_models.html'>chandwich::compare_models</a>: implementation of the comparison
mechanism</p>
<p><a href='https://rdrr.io/pkg/chandwich/man/anova.chandwich.html'>chandwich::anova.chandwich</a>: <code>anova</code> method of the <code>chandwich</code>
package, which also uses <code>compare.models()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># from Introducing Chandwich.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>250</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></span><span class='op'>(</span><span class='fl'>250</span>, mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>x</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>fm_pois</span> <span class='op'>&lt;-</span> <span class='fu'><a href='glm.html'>glm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='va'>poisson</span><span class='op'>)</span>
<span class='va'>fm_pois_adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='adj_loglik.html'>adj_loglik</a></span><span class='op'>(</span><span class='va'>fm_pois</span><span class='op'>)</span>
<span class='va'>fm_pois_small_adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fm_pois_adj</span>, formula <span class='op'>=</span> <span class='va'>.</span> <span class='op'>~</span> <span class='va'>.</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>fm_pois_smallest_adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fm_pois_adj</span>, formula <span class='op'>=</span> <span class='va'>.</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>fm_pois_adj</span>, <span class='va'>fm_pois_small_adj</span>, <span class='va'>fm_pois_smallest_adj</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Analysis of Adjusted Deviance Table
#&gt; 
#&gt; Model 1: y ~ x + I(x^2)
#&gt; Model 2: y ~ x
#&gt; Model 3: y ~ 1
#&gt;   Resid.df df  ALRTS Pr(&gt;ALRTS)    
#&gt; 1      247                         
#&gt; 2      248  1   1.82     0.1773    
#&gt; 3      249  1 116.73     &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='co'># use different types of adjustment with type, default is "vertical"</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>fm_pois_adj</span>, <span class='va'>fm_pois_small_adj</span>, <span class='va'>fm_pois_smallest_adj</span>, type <span class='op'>=</span> <span class='st'>"cholesky"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Analysis of Adjusted Deviance Table
#&gt; 
#&gt; Model 1: y ~ x + I(x^2)
#&gt; Model 2: y ~ x
#&gt; Model 3: y ~ 1
#&gt;   Resid.df df  ALRTS Pr(&gt;ALRTS)    
#&gt; 1      247                         
#&gt; 2      248  1   1.89     0.1693    
#&gt; 3      249  1 165.99     &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'># sequential anova</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>fm_pois_adj</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Analysis of Adjusted Deviance Table
#&gt; 
#&gt; Model 1: y ~ x + I(x^2)
#&gt; Model 2: y ~ x
#&gt; Model 3: y ~ 1
#&gt;            Resid.df df  ALRTS Pr(&gt;ALRTS)    
#&gt; full model      247                         
#&gt; I(x^2)          248  1   1.82     0.1773    
#&gt; x               249  1 116.73     &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Theo Bruckbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


